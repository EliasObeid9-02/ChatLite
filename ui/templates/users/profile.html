{% extends is_htmx_request|yesno:"_base.html,base.html" %}
{% block layout %}
    <div class="columns is-centered">
        <div class="column is-two-fifths">
            <div class="card">
                <div class="card-content has-text-centered">
                    <p class="title">{{ profile.display_name }}'s Profile</p>
                    {% if profile.profile_picture %}
                        <figure class="image is-128x128 is-inline-block mb-4">
                            <img src="{{ profile.profile_picture }}"
                                 alt="Profile Picture"
                                 class="is-rounded">
                        </figure>
                    {% endif %}
                    {% if is_owner %}
                        <form hx-post="{% url 'users:profile' username=profile.user.username %}"
                              hx-encoding="multipart/form-data"
                              enctype="multipart/form-data"
                              hx-target="#content"
                              hx-swap="innerHTML">
                            {% csrf_token %}
                            {% include "partials/_form.html" %}
                            <div class="field">
                                <div class="file is-fullwidth has-name">
                                    <label class="file-label">
                                        <input class="file-input"
                                               type="file"
                                               name="profile_picture_file"
                                               accept="image/png, image/jpeg, image/gif">
                                        <span class="file-cta">
                                            <span class="file-icon">
                                                <i class="fas fa-upload"></i>
                                            </span>
                                            <span class="file-label">Choose a fileâ€¦</span>
                                        </span>
                                        <span class="file-name">No file uploaded</span>
                                    </label>
                                </div>
                            </div>
                            <button type="submit" class="button is-primary">Save Changes</button>
                        </form>
                        <script>
                                const fileInput = document.querySelector('.file-input');
                                const fileName = document.querySelector('.file-name');
                                fileInput.addEventListener('change', () => {
                                    if (fileInput.files.length > 0) {
                                        fileName.textContent = fileInput.files[0].name;
                                    } else {
                                        fileName.textContent = 'No file uploaded';
                                    }
                                });
                        </script>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
